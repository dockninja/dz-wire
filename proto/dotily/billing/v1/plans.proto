// plan.proto
syntax = "proto3";

package dotily.billing.v1;

import "dotily/billing/v1/billing.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/dockninja/dz-wire/gen/go/dotily/billing/v1;pbbilling";

message PlanPrice {
  string id = 1; // UUID (billing.plan_prices.id)
  string plan_id = 2; // UUID
  BillingProvider provider = 3; // maps payment_provider
  string product_id = 4; // empty => NULL
  string price_id = 5; // required
  bool active = 6;
  google.protobuf.Timestamp created_at = 7;
}

message Plan {
  string id = 1; // UUID (billing.plans.id)
  string code = 2; // "free", "pro", "team"
  string name = 3; // maps plan_name
  bool active = 4;
  google.protobuf.Struct entitlements = 5;
  google.protobuf.Timestamp created_at = 6;
  google.protobuf.Timestamp updated_at = 7;

  repeated PlanPrice prices = 8; // provider mappings (0..n)
}

message UpsertPlanParams {
  string id = 1; // UUID, empty => insert by code (or ignore)
  string code = 2;
  string name = 3;
  bool active = 4;
  google.protobuf.Struct entitlements = 5;
}

message UpsertPlanPriceParams {
  string plan_id = 1; // UUID
  BillingProvider provider = 2;
  string product_id = 3; // empty => NULL
  string price_id = 4;
  bool active = 5;
}
