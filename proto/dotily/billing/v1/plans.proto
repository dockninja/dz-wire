// plan.proto
syntax = "proto3";

package dotily.billing.v1;

import "dotily/billing/v1/billing.proto";
import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/wrappers.proto";

option go_package = "github.com/dockninja/dz-wire/gen/go/dotily/billing/v1;pbbilling";

message Plan {
  int64 id = 1;

  // App-facing identity
  string code = 2; // "free", "pro", "team"
  string name = 3;
  bool active = 4;

  // JSON object: limits/features
  google.protobuf.Struct entitlements = 5;

  // Optional provider mapping (if the plan is backed by Stripe/Lemon)
  BillingProvider provider = 6; // if unspecified => no external provider mapping
  google.protobuf.StringValue product_id = 7;
  google.protobuf.StringValue price_id = 8;

  google.protobuf.Timestamp created_at = 9;
  google.protobuf.Timestamp updated_at = 10;
}

message UpsertPlanRequest {
  string code = 1;
  string name = 2;
  bool active = 3;

  google.protobuf.Struct entitlements = 4;

  BillingProvider provider = 5;
  google.protobuf.StringValue product_id = 6;
  google.protobuf.StringValue price_id = 7;
}

message UpsertPlanResponse {
  Plan plan = 1;
}
